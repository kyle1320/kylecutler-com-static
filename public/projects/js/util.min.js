"use strict";function scaleCanvas(t,i,e){var n=window.devicePixelRatio||1,r=i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1,o=n/r;return t.style.width=t.width+"px",t.style.height=t.height+"px",t.drawWidth=t.width,t.drawHeight=t.height,resizeCanvas(t,i,t.width*o,t.height*o,e),o}function resizeCanvas(t,i,e,n,r){if(void 0===r&&(r=!0),t.width=e,t.height=n,r&&t.drawWidth&&t.drawHeight||(t.drawWidth=e,t.drawHeight=n),r){var o=e/t.drawWidth,a=n/t.drawHeight;t.scalex=o,t.scaley=a,i instanceof CanvasRenderingContext2D&&i.scale(o,a)}}function fitElement(t,i,e,n){i=i||t.clientWidth,e=e||t.clientHeight,n=n||function(){};var r=i/e,o=function(){var o=window.getComputedStyle(t.parentElement,null),a=parseInt(o.getPropertyValue("width")),s=parseInt(o.getPropertyValue("height")),h=Math.min(a,i),u=Math.min(s,e);h>r*u?h=Math.floor(r*u):u=Math.floor(h/r),t.style.width=h+"px",t.style.height=u+"px",n(t)};o(),window.addEventListener("resize",o)}function randomColor(){return"#"+("00000"+Math.floor(16777216*Math.random()).toString(16)).slice(-6)}function getSaturatedColor(t){var i=Math.floor(6*t),e=(6*t-i+1)%1,n=("0"+Math.round(255*(1-e)).toString(16)).slice(-2),r=("0"+Math.round(255*e).toString(16)).slice(-2);switch((i+6)%6){case 0:return"#FF"+r+"00";case 1:return"#"+n+"FF00";case 2:return"#00FF"+r;case 3:return"#00"+n+"FF";case 4:return"#"+r+"00FF";case 5:return"#FF00"+n}}function toRGBString(t,i,e){return"#"+("0"+Math.floor(t).toString(16)).slice(-2)+("0"+Math.floor(i).toString(16)).slice(-2)+("0"+Math.floor(e).toString(16)).slice(-2)}function getRelativeCoord(t,i){var e,n;if(i instanceof MouseEvent)e=i.clientX,n=i.clientY,~i.buttons;else if(window.TouchEvent&&i instanceof TouchEvent){var r=i.changedTouches[0];e=r.clientX,n=r.clientY,!0}var o=t.getBoundingClientRect();return{x:(e-o.left)*(t.drawWidth/t.clientWidth),y:(n-o.top)*(t.drawHeight/t.clientHeight)}}function takeTouchFocus(t){window.TouchEvent&&t instanceof TouchEvent&&t.touches.length<2&&t.preventDefault()}function linkCheckboxToBoolean(t,i,e,n){n=n||function(){},t.checked=i[e],t.addEventListener("click",function(){i[e]=t.checked,n()})}function linkInputToNumber(t,i,e,n,r){n=n||function(){},void 0===r&&(r=!0),t.value=String(i[e]),r?t.addEventListener("input",function(){isNaN(t.valueAsNumber)||(i[e]=t.valueAsNumber),n()}):t.addEventListener("change",function(){isNaN(t.valueAsNumber)||(i[e]=t.valueAsNumber),n()}),t.addEventListener("blur",function(){t.value=String(i[e])})}function linkColorChooserToValues(t,i,e,n){n=n||function(){},t.jscolor.fromRGB(i[e][0],i[e][1],i[e][2]),t.addEventListener("change",function(){i[e][0]=Math.floor(255*t.jscolor.rgb[0]),i[e][1]=Math.floor(255*t.jscolor.rgb[1]),i[e][2]=Math.floor(255*t.jscolor.rgb[2]),n()})}function linkColorChooserToHexString(t,i,e,n){n=n||function(){},t.jscolor.fromString(i[e]?i[e].slice(1):""),t.addEventListener("change",function(){i[e]=t.value?"#"+t.jscolor.toString():null,n()})}function linkSelectToString(t,i,e,n){n=n||function(){},t.value=i[e],t.addEventListener("change",function(){i[e]=t.value,n()})}function loadFile(t,i,e,n){n=n||function(){};var r=new XMLHttpRequest;r.open("GET",t,!0),r.onreadystatechange=function(){4==r.readyState&&(200==r.status?e(r.responseText,i):n(t))},r.send(null)}function loadFiles(t,i,e){function n(t,e){a[e]=t,++o==r&&i(a)}for(var r=t.length,o=0,a=[],s=0;s<r;s++)loadFile(t[s],s,n,e)}function QuadTree(t,i,e,n){this.minx=t,this.miny=i,this.maxx=e,this.maxy=n,this.midx=(this.minx+this.maxx)/2,this.midy=(this.miny+this.maxy)/2,this.bucket=[],this.nw=null,this.ne=null,this.sw=null,this.se=null}function poissonDisk(t,i,e,n,r){var o=r*r,a=t+e,s=i+n,h=[{x:Math.random()*e+t,y:Math.random()*n+i}],u=new QuadTree(t,i,a,s),l=[];for(l.push(h[0]),u.insert(h[0]);l.length>0;){for(var c=Math.floor(Math.random()*l.length),d=l[c],f=!1,m=0;m<30;m++){f=!0;var w=Math.random()*r+r,g=2*Math.random()*Math.PI,v=d.x+w*Math.cos(g),x=d.y+w*Math.sin(g);if(v<t||v>=a||x<i||x>=s)f=!1;else{for(var y=u.inRegion(v-r,x-r,v+r,x+r),p=0;p<y.length;p++){var k=v-y[p].x,b=x-y[p].y;if(k*k+b*b<o){f=!1;break}}if(f){var M={x:v,y:x};u.insert(M),h.push(M),l.push(M);break}}}f||l.splice(c,1)}for(var T=$("draw-canvas"),F=T.getContext("2d"),S=0;S<h.length;S++)for(var p=0;p<h.length;p++)F.fillRect(T.drawWidth/2+(h[p].x-h[S].x),T.drawHeight/2+(h[p].y-h[S].y),1,1);return h}var $=function(t){return document.getElementById(t)},isNaN=Number.isNaN||window.isNaN||function(t){return"number"==typeof t&&t!==t};Math.clamp=function(t,i,e){return Math.max(i,Math.min(t,e))},Array.prototype.pushAll=function(t){for(var i=0;i<t.length;i++)this.push(t[i])},QuadTree.prototype.insert=function(t){if(t.x<this.minx||t.x>=this.maxx||t.y<this.miny||t.y>=this.maxy)return!1;if(!this.nw){if(this.bucket.length<5)return this.bucket.push(t),!0;this.subdivide()}return this.nw.insert(t)||this.ne.insert(t)||this.sw.insert(t)||this.se.insert(t)},QuadTree.prototype.subdivide=function(t){this.nw=new QuadTree(this.minx,this.miny,this.midx,this.midy),this.ne=new QuadTree(this.midx,this.miny,this.maxx,this.midy),this.sw=new QuadTree(this.minx,this.midy,this.midx,this.maxy),this.se=new QuadTree(this.midx,this.midy,this.maxx,this.maxy);for(var i=0;i<this.bucket.length;i++)this.insert(this.bucket[i]);this.bucket=null},QuadTree.prototype.inRegion=function(t,i,e,n){if(e<this.minx||t>=this.maxx||n<this.miny||i>=this.maxy)return[];if(!this.nw)return this.bucket;var r=[];return r.pushAll(this.nw.inRegion(t,i,e,n)),r.pushAll(this.ne.inRegion(t,i,e,n)),r.pushAll(this.sw.inRegion(t,i,e,n)),r.pushAll(this.se.inRegion(t,i,e,n)),r},QuadTree.prototype.draw=function(t,i,e,n,r,o){var a=(e+r)/2,s=(n+o)/2;if(this.nw)i.beginPath(),i.moveTo(e*t.drawWidth,s*t.drawHeight),i.lineTo(r*t.drawWidth,s*t.drawHeight),i.moveTo(a*t.drawWidth,n*t.drawHeight),i.lineTo(a*t.drawWidth,o*t.drawHeight),i.closePath(),i.strokeStyle="#FF0000",i.stroke(),this.nw.draw(t,i,e,n,a,s),this.ne.draw(t,i,a,n,r,s),this.sw.draw(t,i,e,s,a,o),this.se.draw(t,i,a,s,r,o);else for(var h=0;h<this.bucket.length;h++){var u=this.bucket[h],l=e+(u.x-this.minx)/(this.maxx-this.minx)*(r-e),c=n+(u.y-this.miny)/(this.maxy-this.miny)*(o-n);i.fillStyle="#0000FF",i.fillRect(l*t.drawWidth,c*t.drawHeight,1,1)}},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),window.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.clearTimeout}();