var $=function(a){return document.getElementById(a)};var isNaN=Number.isNaN||window.isNaN||function(a){return typeof a==="number"&&a!==a};function scaleCanvas(b,c){var a=window.devicePixelRatio||1;var d=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1;var e=a/d;b.style.width=b.width+"px";b.style.height=b.height+"px";b.drawWidth=b.width;b.drawHeight=b.height;b.width*=e;b.height*=e;if(c instanceof CanvasRenderingContext2D){c.scale(e,e)}return e}function fitElement(e,b,d,f){b=b||e.clientWidth;d=d||e.clientHeight;f=f||function(){};var a=b/d;var c=function(){var k=window.getComputedStyle(e.parentElement,null);var j=parseInt(k.getPropertyValue("width"));var h=parseInt(k.getPropertyValue("height"));var g=Math.min(j,b);var i=Math.min(h,d);if(g>a*i){g=Math.floor(a*i)}else{i=Math.floor(g/a)}e.style.width=g+"px";e.style.height=i+"px";f(e)};c();window.addEventListener("resize",c)}function randomColor(){return"#"+("00000"+(Math.floor(Math.random()*16777216)).toString(16)).slice(-6)}function getRelativeCoord(c,b){var a,g;var e;if(b instanceof MouseEvent){a=b.clientX;g=b.clientY;e=~b.buttons}else{if(window.TouchEvent&&b instanceof TouchEvent){var f=b.changedTouches[0];a=f.clientX;g=f.clientY;e=true}}var d=c.getBoundingClientRect();return{x:(a-d.left)*(c.drawWidth/c.clientWidth),y:(g-d.top)*(c.drawHeight/c.clientHeight),}}function takeTouchFocus(a){if(window.TouchEvent&&a instanceof TouchEvent){if(a.touches.length<2){a.preventDefault()}}}function getSaturatedColor(a){var c=Math.floor(a*6);var e=((a*6-c)+1)%1;var d=("0"+Math.round(255*(1-e)).toString(16)).slice(-2);var b=("0"+Math.round(255*e).toString(16)).slice(-2);switch((c+6)%6){case 0:return"#FF"+b+"00";case 1:return"#"+d+"FF00";case 2:return"#00FF"+b;case 3:return"#00"+d+"FF";case 4:return"#"+b+"00FF";case 5:return"#FF00"+d}}function linkCheckboxToBoolean(d,b,a,c){c=c||function(){};d.checked=b[a];d.addEventListener("click",function(){b[a]=d.checked;c()})}function linkInputToNumber(b,d,a,e,c){e=e||function(){};if(c===undefined){c=true}b.value=String(d[a]);if(c){b.addEventListener("input",function(){if(!isNaN(b.valueAsNumber)){d[a]=b.valueAsNumber}e()})}else{b.addEventListener("change",function(){if(!isNaN(b.valueAsNumber)){d[a]=b.valueAsNumber}e()})}b.addEventListener("blur",function(){b.value=String(d[a])})}function linkColorChooserToValues(b,c,a,d){d=d||function(){};b.color.fromRGB(c[a][0]/255,c[a][1]/255,c[a][2]/255);b.addEventListener("change",function(){c[a][0]=Math.floor(b.color.rgb[0]*255);c[a][1]=Math.floor(b.color.rgb[1]*255);c[a][2]=Math.floor(b.color.rgb[2]*255);d()})}function linkSelectToString(b,c,a,d){d=d||function(){};b.value=c[a];b.addEventListener("change",function(){c[a]=b.value;d()})}function loadFile(b,d,e,a){a=a||function(){};var c=new XMLHttpRequest();c.open("GET",b,true);c.onreadystatechange=function(){if(c.readyState==4){if(c.status==200){e(c.responseText,d)}else{a(b)}}};c.send(null)}function loadFiles(f,h,b){var g=f.length;var d=0;var a=[];function e(j,i){a[i]=j;d++;if(d==g){h(a)}}for(var c=0;c<g;c++){loadFile(f[c],c,e,b)}}Math.clamp=function(b,c,a){return Math.max(c,Math.min(b,a))};Array.prototype.pushAll=function(b){for(var a=0;a<b.length;a++){this.push(b[a])}};function QuadTree(b,a,d,c){this.minx=b;this.miny=a;this.maxx=d;this.maxy=c;this.midx=(this.minx+this.maxx)/2;this.midy=(this.miny+this.maxy)/2;this.bucket=[];this.nw=null;this.ne=null;this.sw=null;this.se=null}QuadTree.prototype.insert=function(a){if(a.x<this.minx||a.x>=this.maxx||a.y<this.miny||a.y>=this.maxy){return false}if(!this.nw){if(this.bucket.length<5){this.bucket.push(a);return true}this.subdivide()}return this.nw.insert(a)||this.ne.insert(a)||this.sw.insert(a)||this.se.insert(a)};QuadTree.prototype.subdivide=function(b){this.nw=new QuadTree(this.minx,this.miny,this.midx,this.midy);this.ne=new QuadTree(this.midx,this.miny,this.maxx,this.midy);this.sw=new QuadTree(this.minx,this.midy,this.midx,this.maxy);this.se=new QuadTree(this.midx,this.midy,this.maxx,this.maxy);for(var a=0;a<this.bucket.length;a++){this.insert(this.bucket[a])}this.bucket=null};QuadTree.prototype.inRegion=function(b,a,e,d){if(e<this.minx||b>=this.maxx||d<this.miny||a>=this.maxy){return[]}if(!this.nw){return this.bucket}var c=[];c.pushAll(this.nw.inRegion(b,a,e,d));c.pushAll(this.ne.inRegion(b,a,e,d));c.pushAll(this.sw.inRegion(b,a,e,d));c.pushAll(this.se.inRegion(b,a,e,d));return c};function poissonDisk(f,c,v,t,s){var y=s*s;var e=f+v;var b=c+t;var z=[{x:Math.random()*v+f,y:Math.random()*t+c}];var q=new QuadTree(f,c,e,b);var g=[];g.push(z[0]);q.insert(z[0]);while(g.length>0){var l=Math.floor(Math.random()*g.length);var u=g[l];var A=false;for(var w=0;w<30;w++){A=true;var B=Math.random()*s+s;var h=Math.random()*2*Math.PI;var p=u.x+B*Math.cos(h);var o=u.y+B*Math.sin(h);if(p<f||p>=e||o<c||o>=b){A=false;continue}var a=q.inRegion(p-s,o-s,p+s,o+s);for(var x=0;x<a.length;x++){var n=p-a[x].x;var m=o-a[x].y;if(n*n+m*m<y){A=false;break}}if(A){var i={x:p,y:o};q.insert(i);z.push(i);g.push(i);break}}if(!A){g.splice(l,1)}}return z}window.requestAnimFrame=(function(){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1000/60)})})();window.cancelAnimFrame=(function(){return(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.clearTimeout)})();