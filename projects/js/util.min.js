var $=function(a){return document.getElementById(a)};var isNaN=Number.isNaN||window.isNaN||function(a){return typeof a==="number"&&a!==a};function scaleCanvas(c,d,b){var a=window.devicePixelRatio||1;var e=d.webkitBackingStorePixelRatio||d.mozBackingStorePixelRatio||d.msBackingStorePixelRatio||d.oBackingStorePixelRatio||d.backingStorePixelRatio||1;var f=a/e;c.style.width=c.width+"px";c.style.height=c.height+"px";c.drawWidth=c.width;c.drawHeight=c.height;resizeCanvas(c,d,c.width*f,c.height*f,b);return f}function resizeCanvas(d,f,g,a,b){if(b===undefined){b=true}d.width=g;d.height=a;if(!b||!d.drawWidth||!d.drawHeight){d.drawWidth=g;d.drawHeight=a}if(b){var e=g/d.drawWidth;var c=a/d.drawHeight;d.scalex=e;d.scaley=c;if(f instanceof CanvasRenderingContext2D){f.scale(e,c)}}}function fitElement(e,b,d,f){b=b||e.clientWidth;d=d||e.clientHeight;f=f||function(){};var a=b/d;var c=function(){var k=window.getComputedStyle(e.parentElement,null);var j=parseInt(k.getPropertyValue("width"));var h=parseInt(k.getPropertyValue("height"));var g=Math.min(j,b);var i=Math.min(h,d);if(g>a*i){g=Math.floor(a*i)}else{i=Math.floor(g/a)}e.style.width=g+"px";e.style.height=i+"px";f(e)};c();window.addEventListener("resize",c)}function randomColor(){return"#"+("00000"+(Math.floor(Math.random()*16777216)).toString(16)).slice(-6)}function getSaturatedColor(a){var c=Math.floor(a*6);var e=((a*6-c)+1)%1;var d=("0"+Math.round(255*(1-e)).toString(16)).slice(-2);var b=("0"+Math.round(255*e).toString(16)).slice(-2);switch((c+6)%6){case 0:return"#FF"+b+"00";case 1:return"#"+d+"FF00";case 2:return"#00FF"+b;case 3:return"#00"+d+"FF";case 4:return"#"+b+"00FF";case 5:return"#FF00"+d}}function toRGBString(d,c,a){return"#"+("0"+Math.floor(d).toString(16)).slice(-2)+("0"+Math.floor(c).toString(16)).slice(-2)+("0"+Math.floor(a).toString(16)).slice(-2)}function getRelativeCoord(c,b){var a,g;var e;if(b instanceof MouseEvent){a=b.clientX;g=b.clientY;e=~b.buttons}else{if(window.TouchEvent&&b instanceof TouchEvent){var f=b.changedTouches[0];a=f.clientX;g=f.clientY;e=true}}var d=c.getBoundingClientRect();return{x:(a-d.left)*(c.drawWidth/c.clientWidth),y:(g-d.top)*(c.drawHeight/c.clientHeight),}}function takeTouchFocus(a){if(window.TouchEvent&&a instanceof TouchEvent){if(a.touches.length<2){a.preventDefault()}}}function linkCheckboxToBoolean(d,b,a,c){c=c||function(){};d.checked=b[a];d.addEventListener("click",function(){b[a]=d.checked;c()})}function linkInputToNumber(b,d,a,e,c){e=e||function(){};if(c===undefined){c=true}b.value=String(d[a]);if(c){b.addEventListener("input",function(){if(!isNaN(b.valueAsNumber)){d[a]=b.valueAsNumber}e()})}else{b.addEventListener("change",function(){if(!isNaN(b.valueAsNumber)){d[a]=b.valueAsNumber}e()})}b.addEventListener("blur",function(){b.value=String(d[a])})}function linkColorChooserToValues(b,c,a,d){d=d||function(){};b.jscolor.fromRGB(c[a][0],c[a][1],c[a][2]);b.addEventListener("change",function(){c[a][0]=Math.floor(b.jscolor.rgb[0]*255);c[a][1]=Math.floor(b.jscolor.rgb[1]*255);c[a][2]=Math.floor(b.jscolor.rgb[2]*255);d()})}function linkColorChooserToHexString(b,c,a,d){d=d||function(){};b.jscolor.fromString(c[a]?c[a].slice(1):"");b.addEventListener("change",function(){c[a]=b.value?"#"+b.jscolor.toString():null;d()})}function linkSelectToString(b,c,a,d){d=d||function(){};b.value=c[a];b.addEventListener("change",function(){c[a]=b.value;d()})}function loadFile(b,d,e,a){a=a||function(){};var c=new XMLHttpRequest();c.open("GET",b,true);c.onreadystatechange=function(){if(c.readyState==4){if(c.status==200){e(c.responseText,d)}else{a(b)}}};c.send(null)}function loadFiles(f,h,b){var g=f.length;var d=0;var a=[];function e(j,i){a[i]=j;d++;if(d==g){h(a)}}for(var c=0;c<g;c++){loadFile(f[c],c,e,b)}}Math.clamp=function(b,c,a){return Math.max(c,Math.min(b,a))};Array.prototype.pushAll=function(b){for(var a=0;a<b.length;a++){this.push(b[a])}};function QuadTree(b,a,d,c){this.minx=b;this.miny=a;this.maxx=d;this.maxy=c;this.midx=(this.minx+this.maxx)/2;this.midy=(this.miny+this.maxy)/2;this.bucket=[];this.nw=null;this.ne=null;this.sw=null;this.se=null}QuadTree.prototype.insert=function(a){if(a.x<this.minx||a.x>=this.maxx||a.y<this.miny||a.y>=this.maxy){return false}if(!this.nw){if(this.bucket.length<5){this.bucket.push(a);return true}this.subdivide()}return this.nw.insert(a)||this.ne.insert(a)||this.sw.insert(a)||this.se.insert(a)};QuadTree.prototype.subdivide=function(b){this.nw=new QuadTree(this.minx,this.miny,this.midx,this.midy);this.ne=new QuadTree(this.midx,this.miny,this.maxx,this.midy);this.sw=new QuadTree(this.minx,this.midy,this.midx,this.maxy);this.se=new QuadTree(this.midx,this.midy,this.maxx,this.maxy);for(var a=0;a<this.bucket.length;a++){this.insert(this.bucket[a])}this.bucket=null};QuadTree.prototype.inRegion=function(b,a,e,d){if(e<this.minx||b>=this.maxx||d<this.miny||a>=this.maxy){return[]}if(!this.nw){return this.bucket}var c=[];c.pushAll(this.nw.inRegion(b,a,e,d));c.pushAll(this.ne.inRegion(b,a,e,d));c.pushAll(this.sw.inRegion(b,a,e,d));c.pushAll(this.se.inRegion(b,a,e,d));return c};QuadTree.prototype.draw=function(b,m,l,k,g,f){var d=(l+g)/2;var c=(k+f)/2;if(this.nw){m.beginPath();m.moveTo(l*b.drawWidth,c*b.drawHeight);m.lineTo(g*b.drawWidth,c*b.drawHeight);m.moveTo(d*b.drawWidth,k*b.drawHeight);m.lineTo(d*b.drawWidth,f*b.drawHeight);m.closePath();m.strokeStyle="#FF0000";m.stroke();this.nw.draw(b,m,l,k,d,c);this.ne.draw(b,m,d,k,g,c);this.sw.draw(b,m,l,c,d,f);this.se.draw(b,m,d,c,g,f)}else{for(var e=0;e<this.bucket.length;e++){var a=this.bucket[e];var j=l+((a.x-this.minx)/(this.maxx-this.minx))*(g-l);var h=k+((a.y-this.miny)/(this.maxy-this.miny))*(f-k);m.fillStyle="#0000FF";m.fillRect(j*b.drawWidth,h*b.drawHeight,1,1)}}};function poissonDisk(f,c,x,v,u){var B=u*u;var e=f+x;var b=c+v;var D=[{x:Math.random()*x+f,y:Math.random()*v+c}];var t=new QuadTree(f,c,e,b);var g=[];g.push(D[0]);t.insert(D[0]);while(g.length>0){var m=Math.floor(Math.random()*g.length);var w=g[m];var E=false;for(var z=0;z<30;z++){E=true;var F=Math.random()*u+u;var h=Math.random()*2*Math.PI;var s=w.x+F*Math.cos(h);var q=w.y+F*Math.sin(h);if(s<f||s>=e||q<c||q>=b){E=false;continue}var a=t.inRegion(s-u,q-u,s+u,q+u);for(var A=0;A<a.length;A++){var p=s-a[A].x;var n=q-a[A].y;if(p*p+n*n<B){E=false;break}}if(E){var l={x:s,y:q};t.insert(l);D.push(l);g.push(l);break}}if(!E){g.splice(m,1)}}var o=$("draw-canvas");var y=o.getContext("2d");for(var C=0;C<D.length;C++){for(var A=0;A<D.length;A++){y.fillRect(o.drawWidth/2+(D[A].x-D[C].x),o.drawHeight/2+(D[A].y-D[C].y),1,1)}}return D}window.requestAnimFrame=(function(){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1000/60)})})();window.cancelAnimFrame=(function(){return(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.clearTimeout)})();